{% extends 'base.html.twig' %}

{% block title %}Edit API{% endblock %}

{% block body %}
    <h1>Editer l'API</h1>

    {{ include('api/_form.html.twig', {'button_label': 'Update'}) }}

    <section class="container-fluid" id="get_data">
        <h2>Obtenir les dernières données <em>Dernière mise à jour : {{ api.updatedAt }} </em></h2>


{#
        {% if series is defined %}
            <article>
                <h1>Résultats de la recherche d'ID avec "{{ series.expression }}"</h1>

                {% for result in series.results %}
                    <ul>
                        <li>Title : {{ result.title }}</li>
                        <li>API ID : {{ result.id }}</li>
                    </ul>
                {% else %}
                    Aucune série trouvée.
                {% endfor %}
            </article>
        {% endif %}

        <br><br>
#}

        {% if infos is defined %}
            <article>
                <h1>Résultats obtenus</h1>
                <br>
                <form action="" method="get">
                    <input type="hidden" name="update_bdd" value="{{ infos.id }}">
                    <button type="submit">Envoyer en base</button>
                </form>
                <br>

                <ul>
                    <li><strong>Title : </strong>{{ infos.title }}</li>
                    <li><strong>Full Title : </strong>{{ infos.fullTitle }}</li>
                    <li><strong>Year : </strong>{{ infos.year }}</li>
                    <li><strong>Seasons : </strong>{{ infos.tvSeriesInfo.seasons|length }}</li>
                    <li><strong>Runtime : </strong>{{ infos.runtimeMins }} minutes</li>
                    <li><strong>Synopsis : </strong>{{ infos.plot }}</li>
                    <li><strong>Image : </strong>{{ infos.image }}</li>
                </ul>

                {% if details is defined %}
                    <h3>Les saisons en détails</h3>
                    {% for season in details %}
                        <ul>
                            <li><h4>Season {{ loop.index }}</h4></li>
                            <li>Episodes : {{ season.episodes|length }}</li>
                            <br>
                            {% for episode in season.episodes %}
                                <ul>
                                    <li><strong>Episode {{ episode.episodeNumber }}</strong></li>
                                    <li><h6>Title : </h6>{{ episode.title }}</li>
                                    <li><h6>Released : </h6>{{ episode.released }}</li>
                                    <li><h6>Synopsis : </h6>{{ episode.plot }}</li>
                                    <li><h6>Image : </h6>{{ episode.image }}</li>
                                </ul>
                                <br>
                            {% endfor %}
                        </ul>
                        <br>
                    {% endfor %}
                {% endif %}
            </article>
        {% endif %}
    </section>

    <a href="{{ path('api_index') }}">back to list</a>

    {{ include('api/_delete_form.html.twig') }}
{% endblock %}
